{% extends "base.html" %}
{% block content %}
<h2>Create Your Portfolio</h2>
<form id="portfolio-form">
    <label for="name">Full Name:</label>
    <input type="text" id="name" name="name" required>

    <label for="about">About Me:</label>
    <textarea id="about" name="about" required></textarea>

    <label for="skills">Skills (comma separated):</label>
    <input type="text" id="skills" name="skills" required>

    <label for="work">Work Experience:</label>
    <textarea id="work" name="work" required></textarea>

    <label for="projects">Projects:</label>
    <textarea id="projects" name="projects" required></textarea>

    <label for="contact">Contact Information:</label>
    <input type="text" id="contact" name="contact" required>

    <label for="photo">Profile Photo:</label>
    <input type="file" id="photo" name="photo" accept="image/*">

    <label for="social-links">Social Media Links (comma separated):</label>
    <input type="text" id="social-links" name="social-links">

    <button type="button" id="preview-portfolio" class="btn">Preview</button>
    <button type="submit" id="save-portfolio" class="btn">Save Portfolio</button>
</form>

<script>
document.getElementById('preview-portfolio').addEventListener('click', function() {
    const portfolioData = {
        name: document.getElementById('name').value.trim(),
        about: document.getElementById('about').value.trim(),
        skills: document.getElementById('skills').value.trim(),
        work: document.getElementById('work').value.trim(),
        projects: document.getElementById('projects').value.trim(),
        contact: document.getElementById('contact').value.trim(),
        social_links: document.getElementById('social-links').value.trim()
    };

    const photoInput = document.getElementById('photo');
    if (photoInput.files.length > 0) {
        const reader = new FileReader();
        reader.onload = function(event) {
            portfolioData.photo = event.target.result;
            fetchPreview(portfolioData);
        };
        reader.readAsDataURL(photoInput.files[0]);
    } else {
        fetchPreview(portfolioData);
    }
});

function fetchPreview(portfolioData) {
    fetch('/preview-portfolio', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(portfolioData)
    })
    .then(response => response.text())
    .then(html => {
        document.open();
        document.write(html);
        document.close();
    })
    .catch(error => console.error('Error:', error));
}
</script>
{% endblock %}
